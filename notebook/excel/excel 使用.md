### 统计

#### 数据透视表

1. 列数据出现次数
2. 统计列的元素个数

### 判断  IF

- 判断是否相同

  ```vb
  =IF(A1=B1,0,1)
  	' 如果相等输出0,不相等输出1.
  ```

### 查找  VLOOKUP

> 注意把查找数据放在待查数据的第一列

```vb
=VLOOKUP(I2,A$2:C423,3,0)
    ' I2 搜索的关键字.
    ' A$2:C423 搜索范围;注意:$为锚定,如果不加会随着计算式的位置变化.
    ' 3 输出列.
    ' 0|FALSE 精确搜索 1|TRUE 模糊搜索;默认模糊搜索.
=IFERROR(VLOOKUP(I2,A$2:C423,3,0),"")
    'IFERROR让没有匹配的单元格不输出。
=VLOOKUP($A13,$A$2:$E$9,COLUMN(B2),0)
	'COLUMN计数列,
=VLOOKUP($A13,$A$2:$E$9,{3,2,4,5},0)
	'数组输出3,2,4,5列
```
### 计算列个数

```vbscript
=SUMPRODUCT(1/COUNTIF(C:C,C2:C695))
```

### 计算百分比,格式化输出

```
# TEXT格式化
=G7&TEXT(G7/($G7+$H7)," (0.0%)")
```

### 多列合并 &

```vb
=B2&IFERROR("、"&VLOOKUP(A2,A3:$C$23,3,0),"")
	' 根据A列重复项合并B列，用顿号连接。 
	' 向下合并符合条件的单元格内容，之后选中删除重复项。
```

 